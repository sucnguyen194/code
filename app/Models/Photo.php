<?php

namespace App\Models;

use App\Enums\ActiveDisable;
use App\Enums\MediaType;
use Illuminate\Database\Eloquent\Model;
use Spatie\Activitylog\Traits\LogsActivity;

class Photo extends Model
{
    use LogsActivity;

    protected static $logUnguarded = true;
    protected static $submitEmptyLogs = false;
    protected static $logOnlyDirty = true;

    protected $guarded = [];

    public function scopePublic($q){
        $q->wherePublic(ActiveDisable::active);
    }

    public function scopeWithLocale($q){
        return $q->whereLang(session('lang'));
    }

    public function getThumbAttribute(){

        return resize_image($this->image);
    }

    protected static function boot()
    {
        parent::boot(); // TODO: Change the autogenerated stub

        self::saving(function($photo){
            $photo->admin_id = $photo->admin_id ?? auth()->id();
        });
    }
}
